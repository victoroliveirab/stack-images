(()=>{"use strict";const t=(t,i=0,a=t)=>t<=i?i:t>=a?a:t;const i=new class{constructor(){this.V_KEY="KeyV",document.addEventListener("keyup",(({code:t,ctrlKey:i})=>{t===this.V_KEY&&i&&this.handlePaste()}))}set callback(t){this._callback=t}handlePaste(){return t=this,i=void 0,e=function*(){if(!this._callback)throw new Error("A callback must be set prior to pasting");const[t]=yield navigator.clipboard.read(),[i]=t.types,a=yield t.getType(i),e=yield((t=".")=>new Promise(((i,a)=>{const e=new Image;e.src=t,e.onload=()=>i(e),e.onerror=()=>a(`Image ${t} not found`)})))(URL.createObjectURL(a));this._callback(e)},new((a=void 0)||(a=Promise))((function(s,h){function n(t){try{m(e.next(t))}catch(t){h(t)}}function d(t){try{m(e.throw(t))}catch(t){h(t)}}function m(t){var i;t.done?s(t.value):(i=t.value,i instanceof a?i:new a((function(t){t(i)}))).then(n,d)}m((e=e.apply(t,i||[])).next())}));var t,i,a,e}},a=document.getElementById("mode"),e=new class{constructor({limitWidth:t=!1,maxWidth:i=0}={}){this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d"),this.imgs=[],this._limitWidth=t,this._maxWidth=t?i:0,this.canvas.width=0,this.canvas.height=0,this.ctx.globalCompositeOperation="destination-over",this.addImage=this.addImage.bind(this)}get numberOfImgs(){return this.imgs.length}get maxWidth(){return this._maxWidth}set maxWidth(t){if(t<=0)return this._maxWidth=0,void(this._limitWidth=!1);this._maxWidth=t}get limitWidth(){return this._limitWidth}set limitWidth(t){this._limitWidth=t}addImage(t,i){if(this.limitWidth)this.addImageWithLimitation(t);else if("below"===i)this.addImageBelow(t);else{if("right"!==i)throw new Error("Invalid image placement");this.addImageRight(t)}this.paint()}addImageWithLimitation(t){return t.width>this.maxWidth?(this.maxWidth=t.width,this.addImageBelow(t)):t.width+this.canvas.width>this.maxWidth?this.addImageBelow(t):void this.addImageRight(t)}addImageBelow(i){const[a,e]=this.getCanvasDimensions(),s=t(a,i.width),h=t(e+i.height,e);this.resizeCanvas(s,h),this.putImageOnCanvas(i,0,e)}addImageRight(i){const[a,e]=this.getCanvasDimensions(),s=t(a+i.width,a),h=t(e,i.height);this.resizeCanvas(s,h),this.putImageOnCanvas(i,a,0)}getCanvasDimensions(){return[this.canvas.width,this.canvas.height]}paint(){this.imgs.forEach((({image:t,x:i,y:a})=>this.ctx.drawImage(t,i,a)))}putImageOnCanvas(t,i,a){this.imgs.push({image:t,x:i,y:a})}resizeCanvas(t=this.canvas.width,i=this.canvas.height){this.canvas.width=t,this.canvas.height=i}}({limitWidth:!0,maxWidth:window.innerWidth});i.callback=e.addImage,a.addEventListener("change",(()=>{const t=a.value;"automatic"!==t?"manual"!==t&&"best-fit"!==t||(e.limitWidth=!0,e.maxWidth=window.innerWidth):e.maxWidth=0}))})();